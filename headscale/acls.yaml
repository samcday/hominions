acls:
  # Trusted hosts have access to everything.
  - action: accept
    src: [group:trusted]
    dst: [group:all:*, k8s-cluster:*, 6pn-headscale:*]
  # Kube workers can talk to k8s control plane on port 6443, and kubelets on 10250
  - action: accept
    src: [k8s-cluster, tag:kube-worker]
    dst: [tag:control-plane:6443, tag:kube-worker:10250]
  # Kube workloads can talk to kube worker nodes on some Cilium ports.
  - action: accept
    src: [k8s-cluster, tag:kube-worker]
    dst:
      - tag:kube-worker:4240
      - tag:kube-worker:9962
      - tag:kube-worker:9963
      - tag:kube-worker:9965
  # vanilla-megabase (host port because weird upstream chart)
  - action: accept
    src: [k8s-cluster, tag:kube-worker]
    dst: [tag:kube-worker:8123]
  # node-exporter
  - action: accept
    src: [k8s-cluster, tag:kube-worker]
    dst: [tag:kube-worker:9100]
  # Kube workers and things already in cluster CIDR can talk to anything in cluster CIDR.
  # Cilium netpols can be employed to further refine access.
  - action: accept
    src: [k8s-cluster, tag:kube-worker]
    dst: [k8s-cluster:*]
  # Kube workers can talk to everything in samcday-headscale 6PN (for now)
  - action: accept
    src: [k8s-cluster, tag:kube-worker]
    dst: [6pn-headscale:*]

autoApprovers:
  routes:
    # k8s service CIDR
    10.43.0.0/16: [services]

    # samcday-headscale Fly.io 6PN
    fdaa:0:b5a8::/48: [services]

    # Can be collapsed into the parent /15 once this is merged: https://github.com/juanfont/headscale/pull/862/files
    10.42.0.0/24: [tag:kube-worker]
    10.42.1.0/24: [tag:kube-worker]
    10.42.2.0/24: [tag:kube-worker]
    10.42.3.0/24: [tag:kube-worker]
    10.42.4.0/24: [tag:kube-worker]
    10.42.5.0/24: [tag:kube-worker]
    10.42.6.0/24: [tag:kube-worker]
    10.42.7.0/24: [tag:kube-worker]
    10.42.8.0/24: [tag:kube-worker]
    10.42.9.0/24: [tag:kube-worker]
    10.42.10.0/24: [tag:kube-worker]
    10.42.11.0/24: [tag:kube-worker]
    10.42.12.0/24: [tag:kube-worker]
    10.42.13.0/24: [tag:kube-worker]
    10.42.14.0/24: [tag:kube-worker]
    10.42.15.0/24: [tag:kube-worker]
    10.42.16.0/24: [tag:kube-worker]
    10.42.17.0/24: [tag:kube-worker]
    10.42.18.0/24: [tag:kube-worker]
    10.42.19.0/24: [tag:kube-worker]
    10.42.20.0/24: [tag:kube-worker]
    10.42.21.0/24: [tag:kube-worker]
    10.42.22.0/24: [tag:kube-worker]
    10.42.23.0/24: [tag:kube-worker]
    10.42.24.0/24: [tag:kube-worker]
    10.42.25.0/24: [tag:kube-worker]
    10.42.26.0/24: [tag:kube-worker]
    10.42.27.0/24: [tag:kube-worker]
    10.42.28.0/24: [tag:kube-worker]
    10.42.29.0/24: [tag:kube-worker]
    10.42.30.0/24: [tag:kube-worker]
    10.42.31.0/24: [tag:kube-worker]
    10.42.32.0/24: [tag:kube-worker]
    10.42.33.0/24: [tag:kube-worker]
    10.42.34.0/24: [tag:kube-worker]
    10.42.35.0/24: [tag:kube-worker]
    10.42.36.0/24: [tag:kube-worker]
    10.42.37.0/24: [tag:kube-worker]
    10.42.38.0/24: [tag:kube-worker]
    10.42.39.0/24: [tag:kube-worker]
    10.42.40.0/24: [tag:kube-worker]
    10.42.41.0/24: [tag:kube-worker]
    10.42.42.0/24: [tag:kube-worker]
    10.42.43.0/24: [tag:kube-worker]
    10.42.44.0/24: [tag:kube-worker]
    10.42.45.0/24: [tag:kube-worker]
    10.42.46.0/24: [tag:kube-worker]
    10.42.47.0/24: [tag:kube-worker]
    10.42.48.0/24: [tag:kube-worker]
    10.42.49.0/24: [tag:kube-worker]
    10.42.50.0/24: [tag:kube-worker]
    10.42.51.0/24: [tag:kube-worker]
    10.42.52.0/24: [tag:kube-worker]
    10.42.53.0/24: [tag:kube-worker]
    10.42.54.0/24: [tag:kube-worker]
    10.42.55.0/24: [tag:kube-worker]
    10.42.56.0/24: [tag:kube-worker]
    10.42.57.0/24: [tag:kube-worker]
    10.42.58.0/24: [tag:kube-worker]
    10.42.59.0/24: [tag:kube-worker]
    10.42.60.0/24: [tag:kube-worker]
    10.42.61.0/24: [tag:kube-worker]
    10.42.62.0/24: [tag:kube-worker]
    10.42.63.0/24: [tag:kube-worker]
    10.42.64.0/24: [tag:kube-worker]
    10.42.65.0/24: [tag:kube-worker]
    10.42.66.0/24: [tag:kube-worker]
    10.42.67.0/24: [tag:kube-worker]
    10.42.68.0/24: [tag:kube-worker]
    10.42.69.0/24: [tag:kube-worker]
    10.42.70.0/24: [tag:kube-worker]
    10.42.71.0/24: [tag:kube-worker]
    10.42.72.0/24: [tag:kube-worker]
    10.42.73.0/24: [tag:kube-worker]
    10.42.74.0/24: [tag:kube-worker]
    10.42.75.0/24: [tag:kube-worker]
    10.42.76.0/24: [tag:kube-worker]
    10.42.77.0/24: [tag:kube-worker]
    10.42.78.0/24: [tag:kube-worker]
    10.42.79.0/24: [tag:kube-worker]
    10.42.80.0/24: [tag:kube-worker]
    10.42.81.0/24: [tag:kube-worker]
    10.42.82.0/24: [tag:kube-worker]
    10.42.83.0/24: [tag:kube-worker]
    10.42.84.0/24: [tag:kube-worker]
    10.42.85.0/24: [tag:kube-worker]
    10.42.86.0/24: [tag:kube-worker]
    10.42.87.0/24: [tag:kube-worker]
    10.42.88.0/24: [tag:kube-worker]
    10.42.89.0/24: [tag:kube-worker]
    10.42.90.0/24: [tag:kube-worker]
    10.42.91.0/24: [tag:kube-worker]
    10.42.92.0/24: [tag:kube-worker]
    10.42.93.0/24: [tag:kube-worker]
    10.42.94.0/24: [tag:kube-worker]
    10.42.95.0/24: [tag:kube-worker]
    10.42.96.0/24: [tag:kube-worker]
    10.42.97.0/24: [tag:kube-worker]
    10.42.98.0/24: [tag:kube-worker]
    10.42.99.0/24: [tag:kube-worker]
    10.42.100.0/24: [tag:kube-worker]
    10.42.101.0/24: [tag:kube-worker]
    10.42.102.0/24: [tag:kube-worker]
    10.42.103.0/24: [tag:kube-worker]
    10.42.104.0/24: [tag:kube-worker]
    10.42.105.0/24: [tag:kube-worker]
    10.42.106.0/24: [tag:kube-worker]
    10.42.107.0/24: [tag:kube-worker]
    10.42.108.0/24: [tag:kube-worker]
    10.42.109.0/24: [tag:kube-worker]
    10.42.110.0/24: [tag:kube-worker]
    10.42.111.0/24: [tag:kube-worker]
    10.42.112.0/24: [tag:kube-worker]
    10.42.113.0/24: [tag:kube-worker]
    10.42.114.0/24: [tag:kube-worker]
    10.42.115.0/24: [tag:kube-worker]
    10.42.116.0/24: [tag:kube-worker]
    10.42.117.0/24: [tag:kube-worker]
    10.42.118.0/24: [tag:kube-worker]
    10.42.119.0/24: [tag:kube-worker]
    10.42.120.0/24: [tag:kube-worker]
    10.42.121.0/24: [tag:kube-worker]
    10.42.122.0/24: [tag:kube-worker]
    10.42.123.0/24: [tag:kube-worker]
    10.42.124.0/24: [tag:kube-worker]
    10.42.125.0/24: [tag:kube-worker]
    10.42.126.0/24: [tag:kube-worker]
    10.42.127.0/24: [tag:kube-worker]
    10.42.128.0/24: [tag:kube-worker]
    10.42.129.0/24: [tag:kube-worker]
    10.42.130.0/24: [tag:kube-worker]
    10.42.131.0/24: [tag:kube-worker]
    10.42.132.0/24: [tag:kube-worker]
    10.42.133.0/24: [tag:kube-worker]
    10.42.134.0/24: [tag:kube-worker]
    10.42.135.0/24: [tag:kube-worker]
    10.42.136.0/24: [tag:kube-worker]
    10.42.137.0/24: [tag:kube-worker]
    10.42.138.0/24: [tag:kube-worker]
    10.42.139.0/24: [tag:kube-worker]
    10.42.140.0/24: [tag:kube-worker]
    10.42.141.0/24: [tag:kube-worker]
    10.42.142.0/24: [tag:kube-worker]
    10.42.143.0/24: [tag:kube-worker]
    10.42.144.0/24: [tag:kube-worker]
    10.42.145.0/24: [tag:kube-worker]
    10.42.146.0/24: [tag:kube-worker]
    10.42.147.0/24: [tag:kube-worker]
    10.42.148.0/24: [tag:kube-worker]
    10.42.149.0/24: [tag:kube-worker]
    10.42.150.0/24: [tag:kube-worker]
    10.42.151.0/24: [tag:kube-worker]
    10.42.152.0/24: [tag:kube-worker]
    10.42.153.0/24: [tag:kube-worker]
    10.42.154.0/24: [tag:kube-worker]
    10.42.155.0/24: [tag:kube-worker]
    10.42.156.0/24: [tag:kube-worker]
    10.42.157.0/24: [tag:kube-worker]
    10.42.158.0/24: [tag:kube-worker]
    10.42.159.0/24: [tag:kube-worker]
    10.42.160.0/24: [tag:kube-worker]
    10.42.161.0/24: [tag:kube-worker]
    10.42.162.0/24: [tag:kube-worker]
    10.42.163.0/24: [tag:kube-worker]
    10.42.164.0/24: [tag:kube-worker]
    10.42.165.0/24: [tag:kube-worker]
    10.42.166.0/24: [tag:kube-worker]
    10.42.167.0/24: [tag:kube-worker]
    10.42.168.0/24: [tag:kube-worker]
    10.42.169.0/24: [tag:kube-worker]
    10.42.170.0/24: [tag:kube-worker]
    10.42.171.0/24: [tag:kube-worker]
    10.42.172.0/24: [tag:kube-worker]
    10.42.173.0/24: [tag:kube-worker]
    10.42.174.0/24: [tag:kube-worker]
    10.42.175.0/24: [tag:kube-worker]
    10.42.176.0/24: [tag:kube-worker]
    10.42.177.0/24: [tag:kube-worker]
    10.42.178.0/24: [tag:kube-worker]
    10.42.179.0/24: [tag:kube-worker]
    10.42.180.0/24: [tag:kube-worker]
    10.42.181.0/24: [tag:kube-worker]
    10.42.182.0/24: [tag:kube-worker]
    10.42.183.0/24: [tag:kube-worker]
    10.42.184.0/24: [tag:kube-worker]
    10.42.185.0/24: [tag:kube-worker]
    10.42.186.0/24: [tag:kube-worker]
    10.42.187.0/24: [tag:kube-worker]
    10.42.188.0/24: [tag:kube-worker]
    10.42.189.0/24: [tag:kube-worker]
    10.42.190.0/24: [tag:kube-worker]
    10.42.191.0/24: [tag:kube-worker]
    10.42.192.0/24: [tag:kube-worker]
    10.42.193.0/24: [tag:kube-worker]
    10.42.194.0/24: [tag:kube-worker]
    10.42.195.0/24: [tag:kube-worker]
    10.42.196.0/24: [tag:kube-worker]
    10.42.197.0/24: [tag:kube-worker]
    10.42.198.0/24: [tag:kube-worker]
    10.42.199.0/24: [tag:kube-worker]
    10.42.200.0/24: [tag:kube-worker]
    10.42.201.0/24: [tag:kube-worker]
    10.42.202.0/24: [tag:kube-worker]
    10.42.203.0/24: [tag:kube-worker]
    10.42.204.0/24: [tag:kube-worker]
    10.42.205.0/24: [tag:kube-worker]
    10.42.206.0/24: [tag:kube-worker]
    10.42.207.0/24: [tag:kube-worker]
    10.42.208.0/24: [tag:kube-worker]
    10.42.209.0/24: [tag:kube-worker]
    10.42.210.0/24: [tag:kube-worker]
    10.42.211.0/24: [tag:kube-worker]
    10.42.212.0/24: [tag:kube-worker]
    10.42.213.0/24: [tag:kube-worker]
    10.42.214.0/24: [tag:kube-worker]
    10.42.215.0/24: [tag:kube-worker]
    10.42.216.0/24: [tag:kube-worker]
    10.42.217.0/24: [tag:kube-worker]
    10.42.218.0/24: [tag:kube-worker]
    10.42.219.0/24: [tag:kube-worker]
    10.42.220.0/24: [tag:kube-worker]
    10.42.221.0/24: [tag:kube-worker]
    10.42.222.0/24: [tag:kube-worker]
    10.42.223.0/24: [tag:kube-worker]
    10.42.224.0/24: [tag:kube-worker]
    10.42.225.0/24: [tag:kube-worker]
    10.42.226.0/24: [tag:kube-worker]
    10.42.227.0/24: [tag:kube-worker]
    10.42.228.0/24: [tag:kube-worker]
    10.42.229.0/24: [tag:kube-worker]
    10.42.230.0/24: [tag:kube-worker]
    10.42.231.0/24: [tag:kube-worker]
    10.42.232.0/24: [tag:kube-worker]
    10.42.233.0/24: [tag:kube-worker]
    10.42.234.0/24: [tag:kube-worker]
    10.42.235.0/24: [tag:kube-worker]
    10.42.236.0/24: [tag:kube-worker]
    10.42.237.0/24: [tag:kube-worker]
    10.42.238.0/24: [tag:kube-worker]
    10.42.239.0/24: [tag:kube-worker]
    10.42.240.0/24: [tag:kube-worker]
    10.42.241.0/24: [tag:kube-worker]
    10.42.242.0/24: [tag:kube-worker]
    10.42.243.0/24: [tag:kube-worker]
    10.42.244.0/24: [tag:kube-worker]
    10.42.245.0/24: [tag:kube-worker]
    10.42.246.0/24: [tag:kube-worker]
    10.42.247.0/24: [tag:kube-worker]
    10.42.248.0/24: [tag:kube-worker]
    10.42.249.0/24: [tag:kube-worker]
    10.42.250.0/24: [tag:kube-worker]
    10.42.251.0/24: [tag:kube-worker]
    10.42.252.0/24: [tag:kube-worker]
    10.42.253.0/24: [tag:kube-worker]
    10.42.254.0/24: [tag:kube-worker]
    10.42.255.0/24: [tag:kube-worker]

groups:
  group:all: [hcloud, hominion, inner, services]
  group:trusted: [hominion, inner]

hosts:
  k8s-cluster: 10.42.0.0/15
  6pn-headscale: fdaa:0:b5a8::/48

tagOwners:
  tag:control-plane: [hominion]
  tag:kube-worker: [hcloud, hominion, inner]
